<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>AES with Cryptojs</title>
    <style>
        body {
            display: none;
        }
    </style>
</head>
<body>
    <div id="result"></div>
    <script src="aes.js"></script>
    <script>
        function displayResult(resultText) {
            document.getElementById('result').textContent = resultText;
        }

        function encrypt(text, password) {
            return CryptoJS.AES.encrypt(text, password).toString();
        }

        function decrypt(encryptedText, password) {
            try {
                const decryptedBytes = CryptoJS.AES.decrypt(encryptedText, password);
                return decryptedBytes.toString(CryptoJS.enc.Utf8);
            } catch (error) {
                return 'AES Decryption Failure';
            }
        }

        function handleQueryParameters() {
            const queryParams = new URLSearchParams(window.location.search);
            const action = queryParams.get('action');
            const text = queryParams.get('text');
            const password = queryParams.get('password');

            if (action === 'encrypt' && text && password) {
                const textWithoutQuotes = text.replace(/"/g, ''); // Remove double quotes
                const encryptedText = encrypt(textWithoutQuotes, password);
                displayResult(encryptedText);
            } else if (action === 'decrypt' && text && password) {
                const decodedText = decodeURIComponent(text); // Decode URL-encoded text
                const decryptedText = decrypt(decodedText, password);
                displayResult(decryptedText);
            } else {
                displayResult('Invalid query parameters.');
            }

            document.body.style.display = 'block'; // Show the body after processing
        }

        handleQueryParameters();
    </script>
</body>
</html>
